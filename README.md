# About Multi-physics Network Model (MpNM)

MpNM is a network model framework for simulating multi-physics processes (e.g., flow and heat transfer) in porous media, written in Python. It is jointly developed by **Zhejiang University** and **Imperial College London**.

In addition to standard single-network simulations (e.g., using pore networks generated by [pnextract](https://github.com/ImperialCollegeLondon/pnextract)), **MpNM supports dual-network modeling**, where separate pore and solid networks are coupled to simulate **simultaneous mass and heat transfer** in both the void space and the solid matrix.

The framework is fully compatible with:
- [pnextract](https://github.com/ImperialCollegeLondon/pnextract) â€” pore network extraction from micro-CT images (Imperial College London)
- [GenExtract](https://github.com/iPMLab/GenExtract) â€” generalized network extraction tool (iPMLab)

The source code is being modularized and will be released incrementally alongside example datasets for demonstration and validation.

---

## How to Install?

```bash
pip install mpnm
```

Ensure you have Python â‰¥ 3.8 and dependencies such as NumPy, SciPy, pandas, and numba installed.

## How to Use?

```python
from mpnm import network, topotools, algorithm
```

> **Note**: The package name is lowercase `mpnm` in code, even though the project is referred to as "MpNM".

---

### Example 1: Absolute Permeability Calculation

This example computes the absolute permeability of a bead packing using a single-phase flow simulation on a pore network.

ğŸ“ **Input Data**:

Located in `sample_data/Bead_packing/`, the required files are:

- `Bead_packing_1000_25_node1.dat`
- `Bead_packing_1000_25_node2.dat`
- `Bead_packing_1000_25_link1.dat`
- `Bead_packing_1000_25_link2.dat`

These can be generated using `pnextract`.

ğŸ”§ **Run the simulation**:

```bash
cd single_phase_flow/
python single_phase_permeability.py
```

This script solves the steady-state Stokes flow, computes mass balance, and outputs absolute permeability in mÂ².

---

### Example 2: Coupled Heat and Mass Transfer (Dual-Network Model)

This advanced example simulates conjugate heat transfer in a porous medium using a dual-network approach:

- **Pore network**: models fluid flow and convective heat transfer.
- **Solid network**: models conductive heat transfer through the solid phase.
- **Interface throats**: connect pore and solid networks to enable thermal coupling.

ğŸ“ **Input Data**:

Located in `sample_data/Sphere_stacking_250_500_2800_20/`, including:

- Pore network files
- Solid network files (`solid_center_*.csv`, `dual_network_interface_*.csv`, etc.)

ğŸ”§ **Features**:

- Iterative coupling between pressure and temperature fields
- Temperature-dependent fluid viscosity
- Nusselt-number-based interfacial heat transfer coefficient
- Robin/Neumann/Dirichlet boundary conditions
- Layer-wise post-processing for velocity and temperature profiles

ğŸ“Š **Outputs**:

- Local wall temperature
- Solid and fluid temperature distributions
- Heat transfer coefficients
- Velocity profiles
- Convergence iteration count
- VTK files for visualization (via `network2vtk`)

This example demonstrates MpNMâ€™s capability in multi-physics, multi-domain simulations relevant to geothermal systems, heat exchangers, and energy storage in porous media.

---

## Contact

For questions, collaboration, or access to additional demos and documentation, please contact:

- Qingyang Lin â€“ [qingyan_lin@zju.edu.cn](mailto:qingyan_lin@zju.edu.cn)
- Mingliang Qu â€“ [mingliangqu@zju.edu.cn](mailto:mingliangqu@zju.edu.cn)
- Jinping Yang â€“ [12227053@zju.edu.cn](mailto:12227053@zju.edu.cn)

We welcome contributions and feedback from the porous media and computational physics communities!